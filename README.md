preload
=======

预加载效果


最近在一个webapp项目中，了解到预加载和进度条的使用。

在一个普通的网页中，如果图片过多，会感觉网页比较慢，而且打开的都是缺乏加载图片的页面，比较残缺，影响用户体验。
当做一个webapp时会遇到跟多这种情况，需要加载很多很大的图片和数据。这时预加载和进度条就发挥作用了。

之前在一个微博里面看到，做了一个软件，由于优化的很好，很快就打开了，防止客户认为软件太简单，所以加上了一个加载进度条，显示加载一段时间（其实早就加载好了），这样就显得软件很复杂。

其实这也是一个用户心里，更多的用户愿意等待进度条，等待加载，而不是单独的等待网页的加载。这一点尤其适用与webapp，以及移动端的webapp。

一. 预加载——image();
本文部分参考与：http://www.jb51.net/article/28113.htm
图像预载入 
对于浏览器载入图像来说，只有在对图像发送一个 HTTP请求之后，它们才会被浏览器载入，对图像的 HTTP 请求要么使用 ＜img＞ 标记，要么通过方法调用实现。如果使用 JavaScript 脚本来处理在 mouseover 事件时交换图像，或者在一段时间之后自动更改图像，那么在从服务器获取图像时可能要等上几秒钟到几分钟的时间。如果使用一个慢速的 Internet 连接，或者要获取的图像非常大，或者其它一些情况，这种现象就特别明显；这样，延迟就造成你不能达到自己期望的效果。 
一些浏览器采用一些措施来缓解这一问题，比如试图通过在本地缓存中存储图像，从而使随后对图像的调用能够立即被满足；但是在图像第一次被调用时依然会存在一些延迟。预载入是在需要图像之前将其下载到缓存的一种方法。通过这一措施，当真正需要图像时，它就可以被立即从缓存中取出，从而能够立即显示。
预载入图像最简单的方法是在 JavaScript 中实例化一个新 Image() 对象，然后将需要载入的图像的 URL 作为参数传入。
简单的预加载：
heavyImage = new Image(); 
heavyImage.src = "heavyimagefile.jpg"; 
备注：这里的图片不需要再使用<img>插入html中，而是已经加载到本地，随时可以通过js调用。

实例：


假设我们有一个图像叫做heavyimagefile.jpg，在用户的鼠标放到一个已经显示的图像之上时，我们希望显示这个图像。为了预载入这一图像从而得到较快的响应时间，我们简单地创建一个 Image() 对象 heavyImage，然后在 onLoad() 事件处理器中将其同时载入。

Image() 对象也有一些事件处理器，其中最有用的一个肯定是 onLoad() 处理器，它在图像完全载入之后调用。这个事件处理器可以与一个自定义函数联系起来，以在图像完全载入之后执行一些特定的任务。

onLoad()配合进度条非常实用，例如加载20张图片，每加载完一张就执行一个计数器函数，返回给进度条参数，这就能返回加载百分比和进度。

此外这里：http://www.w3school.com.cn/htmldom/dom_obj_image.asp  还有很多Image()属性的介绍。

二.进度条——html5方法和非html5方法
首先介绍下html5的进度条使用方法
核心代码：
<progress id="prog" value="0" max="100"></progress>

修改value的值会，页面上面会对应出相应的进度。
var prBar = document.getElementById("prog");
prBar.value=20;
这里就是20%的进度，如下图

这里结合上面的预加载，20张图片，没加载完成一张图片就累加一次，加载玩10张图片就是50%的进度，prBar.value设置为50即可。


对与非html5 也比较好处理，运用各种css设置对应的background,with,left即可，关键在于每次加载完成一个项目（这里不限定图片），需要返回一个值。用返回的值设置参数。


三.webapp实例使用
一个案例放在网盘中，这个google一个电子书webapp的预加载效果，我修改了下
http://pan.baidu.com/share/link?shareid=365825&uk=52813371

另外在加载玩图片是可以直接通过：
$('div.page').find('img')[8].src="http://v.crystaledu.com/uploadfile/2010/0816/1281926046.jpg";
方式引用。
